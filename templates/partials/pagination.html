{# Reusable pagination partial. Expects: page_obj, request.GET dict, optional page_size variable. #}
{% if page_obj %}
<nav aria-label="Pagination" class="my-3">
  <form method="get" class="d-flex align-items-center mb-2 gap-2">
    {# Preserve existing filters except page & page_size #}
    {% for key, val in request.GET.items %}
      {% if key not in 'page page_size' %}
        <input type="hidden" name="{{ key }}" value="{{ val }}">
      {% endif %}
    {% endfor %}
    <label class="form-label mb-0 small">Per Page:</label>
    <select name="page_size" class="form-select form-select-sm" onchange="this.form.submit()">
      <option value="25" {% if page_size == 25 or page_size == '25' %}selected{% endif %}>25</option>
      <option value="50" {% if page_size == 50 or page_size == '50' %}selected{% endif %}>50</option>
      <option value="100" {% if page_size == 100 or page_size == '100' %}selected{% endif %}>100</option>
      <option value="150" {% if page_size == 150 or page_size == '150' %}selected{% endif %}>150</option>
      <option value="200" {% if page_size == 200 or page_size == '200' %}selected{% endif %}>200</option>
    </select>
  </form>
  <ul class="pagination mb-0">
    {% if page_obj.has_previous %}
      <li class="page-item"><a class="page-link" href="?page={{ page_obj.previous_page_number }}{% for key,val in request.GET.items %}{% if key != 'page' %}&{{ key }}={{ val }}{% endif %}{% endfor %}">Previous</a></li>
    {% else %}
      <li class="page-item disabled"><span class="page-link">Previous</span></li>
    {% endif %}
    <li class="page-item disabled"><span class="page-link">Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}</span></li>
    {% if page_obj.has_next %}
      <li class="page-item"><a class="page-link" href="?page={{ page_obj.next_page_number }}{% for key,val in request.GET.items %}{% if key != 'page' %}&{{ key }}={{ val }}{% endif %}{% endfor %}">Next</a></li>
    {% else %}
      <li class="page-item disabled"><span class="page-link">Next</span></li>
    {% endif %}
  </ul>
</nav>
{% endif %}
